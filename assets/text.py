from todoist_api_python.models import Task

HELP_TEXT = """
📘 <b>Помощь: как я могу помочь тебе быть продуктивнее?</b> ✨ 

Я — твой умный помощник для Todoist.
Просто говори, что нужно сделать — а я сам всё оформлю: с датами, приоритетами, метками и напоминаниями. 🧠🗓️ 

🛠️ <b>Доступные команды:</b> 

/start — 🏡 Запустить бота и проверить статус подключения
/help — 📘 Показать это сообщение   

🔐
/authenticate — Привязать аккаунт Todoist
/logout — Отвязать аккаунт   

📝
/add — Добавить задачу (можно просто писать текст — я всё пойму!)   

📊
/daily_summary — Получить сводку по задачам на сегодня
/weekly_summary — Получить обзор на неделю вперёд   

🧠 <b>Как это работает?</b>
Напиши что-то вроде:   

«Встреча с дизайнером завтра в 15:00» — и я добавлю задачу с датой, временем и нужным приоритетом.   
     
🔁 Не нужно команд — просто пиши сообщение 😉 

🔐 Всё безопасно: никаких паролей, только официальная авторизация через Todoist. 
""".strip()

START_WITHOUT_AUTH = """
🎉 Добро пожаловать в <b>Todoist Assistant</b>!   

Теперь твои задачи будут появляться в Todoist — умно, быстро и почти магически. ✨
Просто напиши боту, что нужно сделать, а нейросеть сама оформит задачу: с датами, приоритетами и даже контекстом. 🧠📅 

🔐 Чтобы начать, нужно подключить твой Todoist.
👉 Просто нажми: /authenticate   

Это займёт всего пару секунд — и вперёд, покорять списки дел! 🚀
(Никаких паролей, только безопасная авторизация через ссылку.)
""".strip()
START_WITH_AUTH = """
🏡 <b>С возвращением! Добро пожаловать в Todoist-помощника</b> ✨ 

Ты уже подключил свой аккаунт — значит, можешь сразу начинать творить порядок в делах! 🚀   

📌 Просто напиши, что нужно сделать:   

- «Позвонить маме завтра в 19:00»
- «Купить билеты на концерт до пятницы»
- «Срочно: подготовить презентацию к 15 мая»   

🧠 А я — с помощью умной модели:
✅ сам определю дату и время
✅ выставлю приоритет
✅ добавлю в нужный проект (если скажешь)
✅ и даже включу напоминание, если нужно   

🎯 Отправляй своё первое дело — и посмотрим, как это работает! 💬 
"""

START_AUTH = """
🔐 <b>Подключаем Todoist!</b> 

Чтобы я мог добавлять задачи в твой аккаунт, нужно дать разрешение через официальный доступ Todoist.   

✅ Это безопасно
✅ Без передачи паролей
✅ Работает через защищённое соединение   

👉 Просто нажми на ссылку ниже и подтверди подключение:
""".strip()
AUTH_SUCCESS = """
✅ <b>Поздравляем — Todoist подключён!</b> 🎉 

Ты официально вошёл в зону умного планирования 🚀
Теперь просто пиши любую задачу — например:
<i>«Записаться к врачу в четверг»</i>
— а я сам всё оформлю: дату, приоритет и даже напоминание. ⏰🧠 

📌 Совет: можешь писать как угодно — чем естественнее, тем лучше!
Я всё пойму и добавлю в твой Todoist аккуратно и точно. ✅ 

👉 Пробуй прямо сейчас — отправь своё первое дело! 💬 
""".strip()
ALREADY_AUTHENTICATED = """
🔐 <b>Ты уже подключён к Todoist!</b> ✅ 

Твой аккаунт успешно синхронизирован — можешь сразу писать задачи в любом виде, и я их умно добавлю в Todoist. 🚀 

📌 Например:   

- «Встреча с командой в четверг в 14:00»
- «Купить кофе до завтра»
- «Сделать бэкап — срочно, приоритет высокий» 

🧠 Я сам всё распознаю: даты, приоритеты, проекты — без лишних усилий с твоей стороны. 

🛠️ Если хочешь переподключить аккаунт (например, с другим Todoist-профилем), напиши: /logout — и затем снова /authenticate. 
""".strip()
AUTH_FAILED = """
🔴 <b>Что-то пошло не так…</b> 😕 

Не удалось подключиться к Todoist. Возможно, ты не завершил авторизацию или произошёл временный сбой.   

🔁 <b>Не переживай — просто попробуй ещё раз:</b>
Нажми /authenticate и следуй инструкциям в новой ссылке. 

🔐 Всё так же безопасно и без паролей — просто подтверждаешь доступ через Todoist.
""".strip()
CONFIRM_LOGOUT = """
⚠️ <b>Точно хочешь отключить Todoist?</b> 🤔 

Если подтвердишь — я перестану добавлять задачи в твой аккаунт.
Твои старые задачи останутся в Todoist, но новые без подключения не появятся. ❌ 

🔐 Ты всегда сможешь подключиться снова через: /authenticate
""".strip()
LOGOUT_SUCCESS = """
✅ <b>Готово — аккаунт отключён!</b> 🔐❌ 

Твой Todoist больше не связан с этим ботом.
Никакие новые задачи отправляться не будут — ты в полном контроле. 🛡️ 

👋 Не прощаемся надолго!
Когда захочешь снова упростить управление задачами — просто введи: /authenticate — и мы снова станем твоим персональным помощником по продуктивности. 🚀 
""".strip()
LOGOUT_FAILED = """
🔴 <b>Не удалось отключиться</b> 😕 

Что-то пошло не так при попытке отвязать Todoist. Рекомендуем отключить бота напрямую в настройках Todoist → Интеграции. 🔐

Сейчас мы принудительно отключили тебя, но ты всегда можешь подключиться через: /authenticate 🔄
""".strip()
LOGOUT_WITHOUT_AUTH = """
ℹ️ <b>Ты уже вне аккаунта</b> ✅ 

Сейчас ты не подключён к Todoist — и это нормально! 🛌 

🔐 Если захочешь снова добавлять задачи напрямую в Todoist, просто введи: /authenticate — и мы снова станем командой по продуктивности. 💪 

💡 А пока — можешь писать мне как в заметки. Я всё запомню — и добавлю в Todoist, как только подключишься. 
""".strip()
NOT_AUTHENTICATED = """
🔒 <b>Ой, доступ не подключён!</b> 😅 

Чтобы я мог добавлять задачи в твой Todoist, нужно сначала пройти быструю и безопасную авторизацию. 

🚀 Просто нажми: /authenticate — и через пару секунд ты сможешь писать задачи, а я — отправлять их в Todoist автоматически. 

🔐 Без паролей, без рисков — только официальное подключение от Todoist. 
""".strip()

ADD_TASK = """
📝 <b>Напиши свою задачу</b> — просто и естественно: 

- «Позвонить другу завтра вечером»
- «Сделать дз по математике до пятницы»
- «Купить билеты на концерт» 
     
🧠 Я сам определю, когда и как важно, и добавлю в Todoist идеально. 

💬 Просто введи текст — можно прямо в чат, без команд.
(Команда /add уже запущена — ты на шаг впереди! 😉) 
""".strip()
ADD_TASK_FAILED = """
❌ <b>Не удалось добавить задачу</b> 😕 

🔧 Возможно, временный сбой на стороне Todoist,
или возникла проблема при обработке данных. 

🔄 <b>Что можно сделать:</b>
• Попробуй отправить задачу ещё раз
• Проверь, подключён ли аккаунт: /start
• Упрости формулировку, если была сложная дата или структура 
""".strip()
DID_NOT_UNDERSTAND = """
🤔 <b>Не совсем понял, что нужно сделать</b> 

Попробуй сформулировать задачу чуть понятнее. Пиши, как если бы говорил себе в заметки — и я сделаю идеальную задачу. ✅
""".strip()
DELETE_TASK_SUCCESS = f"""
🗑️ <b>Задача удалена</b> — больше не будет висеть на душе

💡 Можешь продолжать управлять задачами через бота или добавлять новые: просто напиши, что нужно сделать.
""".strip()
DELETE_TASK_FAILED = f"""
⚠️ <b>Не удалось удалить задачу</b> 😕

Возможно, она уже удалена, перемещена или у нас временно нет доступа. 🤖💔

🔄 Попробуй обновить список в Todoist.
""".strip()


def VIEW_TASK(task: Task) -> str:

    description_html = f"📌 <b>Описание:</b> {task.description}" if task.description else "📌 <b>Описание:</b> –"
    priority_text = {
        1: "P4 (низкий)",
        2: "P3 (средний)",
        3: "P2 (высокий)",
        4: "P1 (очень высокий) ⚠️"
    }.get(task.priority, "–")
    due_text = task.due.date.strftime("%d.%m.%Y в %H:%M") if task.due and task.due.date else \
        (task.due.date if task.due else "–")

    return f"""
✅ <b>Задача добавлена в Todoist</b> 🎯

📝 <b>Что:</b> <i>{task.content}</i>
{description_html}
⚡ <b>Приоритет:</b> {priority_text}
📅 <b>Время выполнения:</b> {due_text}

🔗 <a href="{task.url}">Открыть в Todoist</a>
""".strip()


ADD_TASK_PROMPT = """
Ты — строгий API-парсер задач. Не веди себя как чат-бот. Отвечай строго в формате JSON и только им. 

Твоя задача — читать мои сообщения и извлекать из них задачи. У каждой задачи выдели:
- content: краткое название задачи (обязательно)
- description: краткое описание (опционально)
- priority: от 1 до 4 (где 4 — высший приоритет)
- due_datetime: дедлайн в формате ISO 8601 (если указан) БЕЗ ВРЕМЕННОГО ОФСЕТА. Также смотри только в будущее — не выбирай дату в прошлом. 

**Отвечай только массивом JSON-объектов. Не пиши никаких комментариев, эмодзи, пояснений. Никаких пояснений до и после. Только массив объектов JSON.**

Если задача не указана, пришли `[]`.

Пример правильного ответа:

[
  {
    "content": "Позвонить маме",
    "description": "",
    "priority": 2,
    "due_datetime": "2025-07-30T18:00:00+03:00",
  }
]
""".strip()
DAILY_SUMMARY_PROMPT = """
Ты выступаешь как мой личный помощник по планированию задач. Я пришлю тебе **JSON-список задач на текущий день**. Твоя задача — **сформировать структурированный план дня**, строго на основе полученных данных.

🧠 **Инструкции:**
- Не придумывай и не изменяй задачи, строго используй переданный JSON.
- Для каждой задачи укажи:
  - **Название задачи** (полностью, как в JSON),
  - **Описание** (если есть),
  - **Время выполнения**,
  - **Приоритет** (где 4 — самый высокий, 1 — самый низкий).
- Учитывай временные рамки и приоритет при построении плана.
- Используй **Markdown** для акцентов для Telegram (`**жирный текст**`, списки и заголовки).
- Добавь **эмодзи** и простую инфографику для визуального удобства.
- Не добавляй вводных, объяснений или размышлений — только **четкий план и рекомендации по выполнению**.

📭 Если список задач пустой, просто скажи:  
_🔔 На сегодня задач нет. Отдыхай или займись чем-то полезным._

🎯 Цель — предоставить лаконичный и полезный план, как у топового task-менеджера.
""".strip()
WEEKLY_SUMMARY_PROMPT = """
Ты выступаешь как мой личный помощник по планированию задач. Я пришлю тебе **JSON-список задач на неделю**. Твоя задача — **сформировать подробный план по дням недели**, строго опираясь на эти данные.

🧠 **Инструкции:**
- Не изменяй задачи и не добавляй вымышленных деталей — работай строго с JSON.
- Для каждой задачи укажи:
  - **Название** (как есть),
  - **Описание** (если присутствует),
  - **Дата и время выполнения**,
  - **Приоритет** (4 — наивысший, 1 — низший).
- Сгруппируй задачи по дням недели, начиная с **понедельника**.
- Учитывай приоритет и временные рамки при построении плана.
- Используй **Markdown-разметку** для Telegram (`**важно**`, списки и т.д.).
- Добавь **эмодзи** и элементы инфографики для наглядности.
- Внизу каждого дня можешь кратко указать советы по выполнению задач.

📭 Если список задач пустой, выведи:
_📆 На неделю задач не запланировано. Планируй разумно и не забывай про отдых._

🎯 Цель — создать аккуратный недельный план, который удобно читать и использовать.
""".strip()


OPENROUTER_CONNECTION_FAILED = """
🤖 <b>Связь с умным ядром потеряна</b>

Не удалось обработать запрос — возможно, временные неполадки у OpenRouter.  
Попробуй ещё раз через пару секунд. Я почти жив! 💡🔧
""".strip()
TODOIST_CONNECTION_FAILED = """
⚠️ <b>Не удалось подключиться к Todoist</b>

Возможно, сервис временно недоступен или возникла сетевая ошибка.  
Попробуй позже — твои задачи никуда не денутся! 📵🔄
""".strip()
